<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kacper's List</title>
<style>
html, body { height:100%; margin:0; font-family:'Segoe UI',Roboto,sans-serif; background:#000; display:flex; justify-content:center; align-items:center; }
.bg { position:absolute; inset:0; background-image:url('81161308.webp'); background-size:cover; background-position:center; z-index:0; }
.glass { position:relative; z-index:5; width:90%; height:90%; padding:30px; background:rgba(255,255,255,0.08); backdrop-filter:blur(10px) saturate(120%); border-radius:24px; border:1px solid rgba(255,255,255,0.06); display:flex; flex-direction:column; align-items:center; justify-content:flex-start; gap:15px; }
.leaderboard { width:100%; height:100%; display:flex; flex-direction:column; align-items:center; gap:12px; overflow-y:auto; padding-right:6px; }
.card { display:flex; width:95%; background:rgba(255,255,255,0.08); border-radius:16px; overflow:hidden; position:relative; min-height:100px; }
.card iframe { width:180px; height:100%; border:none; flex-shrink:0; }
.card-info { padding:10px 12px; display:flex; flex-direction:column; justify-content:center; flex:1; }
.card-info .rank { font-weight:700; font-size:1rem; }
.card-info .level-name { font-size:1.1rem; font-weight:600; }
.card-info .creator { font-size:0.9rem; color:#ccc; }
.card-sender { position:absolute; top:6px; right:10px; font-size:0.85rem; font-weight:600; color:#53baff; }
.discord-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.7); display:flex; align-items:center; justify-content:center; opacity:0; pointer-events:none; transition:opacity 0.3s ease; z-index:10; }
.discord-overlay.active { opacity:1; pointer-events:auto; }
.discord-popup { background:rgba(255,255,255,0.12); backdrop-filter:blur(16px); border-radius:24px; border:1px solid rgba(255,255,255,0.15); padding:30px; width:380px; display:flex; flex-direction:column; gap:12px; color:#fff; box-shadow:0 12px 40px rgba(0,0,0,0.5); font-size:1rem; transform:translateY(50px); opacity:0; transition:transform 0.35s ease, opacity 0.35s ease; }
.discord-overlay.active .discord-popup { transform:translateY(0); opacity:1; }
.user-info { display:flex; align-items:center; gap:10px; font-size:0.95rem; position:absolute; bottom:10px; left:10px; z-index:20; }
.user-info img { width:32px; height:32px; border-radius:50%; }
.user-info button { padding:6px 10px; border:none; border-radius:8px; cursor:pointer; background:#F44336; color:#fff; font-weight:600; }
</style>
</head>
<body>

<div class="bg"></div>

<div class="glass">
  <div class="leaderboard" id="leaderboardContainer"></div>
</div>

<div class="discord-overlay" id="discordOverlay">
  <div class="discord-popup">
    <h3>Login with Discord</h3>
    <button id="discordLogin">Login</button>
  </div>
</div>

<div class="user-info" id="userInfo" style="display:none;">
  <img src="" id="userAvatar">
  <span id="userName"></span>
  <button id="logoutBtn">Logout</button>
</div>

<script>
const discordOverlay = document.getElementById('discordOverlay');
const discordLogin = document.getElementById('discordLogin');
const userInfo = document.getElementById('userInfo');
const userName = document.getElementById('userName');
const userAvatar = document.getElementById('userAvatar');
const logoutBtn = document.getElementById('logoutBtn');
const leaderboardContainer = document.getElementById('leaderboardContainer');

let discordUser = null;

function checkLogin(){
  discordUser = JSON.parse(localStorage.getItem('discordUser')||'null');
  if(!discordUser){
    discordOverlay.classList.add('active');
  } else {
    discordOverlay.classList.remove('active');
    userInfo.style.display='flex';
    userName.textContent = discordUser.username;
    userAvatar.src = discordUser.avatar;
    loadLeaderboard();
  }
}
checkLogin();

// Discord OAuth redirect
discordLogin.addEventListener('click', ()=>{
  window.location.href = "https://discord.com/oauth2/authorize?client_id=1445110495618269225&response_type=code&redirect_uri=https%3A%2F%2Ftehnoobiegd.github.io%2Fkacper-s-list%2F&scope=identify";
});

// Simulate logged in after redirect (replace with proper OAuth handler)
if(window.location.search.includes('code=')){
  // Demo: normally you exchange code server-side for user info
  discordUser = {username:'TestUser', avatar:'https://cdn.discordapp.com/embed/avatars/0.png'};
  localStorage.setItem('discordUser', JSON.stringify(discordUser));
  window.history.replaceState({}, document.title, window.location.pathname);
  checkLogin();
}

logoutBtn.addEventListener('click', ()=>{
  localStorage.removeItem('discordUser');
  discordUser=null;
  checkLogin();
});

function loadLeaderboard(){
  leaderboardContainer.innerHTML='';
  let leaderboard = JSON.parse(localStorage.getItem('leaderboard')||'[]');
  leaderboard.sort((a,b)=>a.rank-b.rank);
  leaderboard.forEach(item=>{
    const card = document.createElement('div');
    card.classList.add('card');
    card.innerHTML=`
      <iframe src="https://www.youtube.com/embed/${parseYoutubeID(item.youtube)}" allowfullscreen></iframe>
      <div class="card-info">
        <div class="rank">#${item.rank}</div>
        <div class="level-name">${item.name}</div>
        <div class="creator">by ${item.creator}</div>
      </div>
      <div class="card-sender">${item.discord}</div>
    `;
    leaderboardContainer.appendChild(card);
  });
}

function parseYoutubeID(url){
  try{
    const u = new URL(url);
    if(u.hostname.includes('youtu.be')) return u.pathname.slice(1);
    if(u.searchParams.get('v')) return u.searchParams.get('v');
    return '';
  } catch{return '';}
}
</script>

</body>
</html>
