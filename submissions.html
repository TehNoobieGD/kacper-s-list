<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kacper's List Submissions</title>
<style>
body { margin:0; font-family:'Segoe UI',Roboto,sans-serif; background:#111; color:#fff; display:flex; justify-content:center; align-items:center; min-height:100vh; }
.container { width:90%; max-width:1000px; padding:30px; background:rgba(255,255,255,0.05); backdrop-filter:blur(10px); border-radius:20px; }
h1 { text-align:center; margin-bottom:20px; }
.submissions-list { display:flex; flex-direction:column; gap:12px; max-height:600px; overflow-y:auto; }
.card { display:flex; width:100%; background:rgba(255,255,255,0.08); border-radius:16px; overflow:hidden; position:relative; }
.card iframe { width:180px; height:100px; border:none; flex-shrink:0; }
.card-info { padding:10px 12px; display:flex; flex-direction:column; justify-content:center; flex:1; }
.card-info .rank { font-weight:700; font-size:1rem; }
.card-info .level-name { font-size:1.1rem; font-weight:600; }
.card-info .creator { font-size:0.9rem; color:#ccc; }
.card-sender { position:absolute; top:6px; right:10px; font-size:0.85rem; font-weight:600; color:#53baff; }
.card button.delete { position:absolute; bottom:6px; right:10px; background:#F44336; border:none; border-radius:6px; color:#fff; padding:4px 8px; cursor:pointer; font-weight:600; }
.password-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.85); display:flex; justify-content:center; align-items:center; flex-direction:column; gap:12px; z-index:100; }
.password-overlay input { padding:12px 16px; font-size:1rem; border-radius:12px; border:none; outline:none; }
.password-overlay button { padding:12px 24px; font-size:1rem; border-radius:12px; border:none; cursor:pointer; background:linear-gradient(135deg,#53baff,#6be3ff); color:#fff; font-weight:600; }
.error-msg { color:#ff4d4d; font-size:0.9rem; display:none; }
.rank-input { width:60px; padding:4px 8px; border-radius:6px; border:none; outline:none; margin-right:6px; }
</style>
</head>
<body>

<div class="password-overlay" id="passwordOverlay">
  <h2>Enter Password</h2>
  <input type="password" id="passInput" placeholder="Password">
  <button id="passBtn">Enter</button>
  <div class="error-msg" id="passError">Wrong password!</div>
</div>

<div class="container" id="mainContainer" style="display:none;">
  <h1>All Submissions</h1>
  <div class="submissions-list" id="submissionList"></div>
</div>

<script>
const PASSWORD = "spring@53!rÃ§";
const overlay = document.getElementById('passwordOverlay');
const passInput = document.getElementById('passInput');
const passBtn = document.getElementById('passBtn');
const passError = document.getElementById('passError');
const mainContainer = document.getElementById('mainContainer');
const submissionList = document.getElementById('submissionList');

async function sha256(message){
  const msgBuffer = new TextEncoder().encode(message);
  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  return hashArray.map(b=>b.toString(16).padStart(2,'0')).join('');
}

passBtn.addEventListener('click', async ()=>{
  const inputHash = await sha256(passInput.value);
  const realHash = await sha256(PASSWORD);
  if(inputHash===realHash){
    overlay.style.display='none';
    mainContainer.style.display='block';
    loadSubmissions();
  } else passError.style.display='block';
});

function loadSubmissions(){
  submissionList.innerHTML='';
  let submissions = JSON.parse(localStorage.getItem('submissions')||'[]');
  let leaderboard = JSON.parse(localStorage.getItem('leaderboard')||'[]');
  
  submissions.forEach((sub,i)=>{
    const card = document.createElement('div');
    card.classList.add('card');
    card.innerHTML = `
      <iframe src="https://www.youtube.com/embed/${parseYoutubeID(sub.youtube)}" allowfullscreen></iframe>
      <div class="card-info">
        <div class="rank">Pending</div>
        <div class="level-name">${sub.name}</div>
        <div class="creator">by ${sub.creator}</div>
      </div>
      <div class="card-sender">${sub.discord}</div>
      <button class="delete">X</button>
    `;
    submissionList.appendChild(card);

    // Delete submission
    card.querySelector('.delete').addEventListener('click', ()=>{
      submissions.splice(i,1);
      localStorage.setItem('submissions', JSON.stringify(submissions));
      loadSubmissions();
    });
  });

  // Show leaderboard too
  leaderboard.forEach(item=>{
    const card = document.createElement('div');
    card.classList.add('card');
    card.innerHTML = `
      <iframe src="https://www.youtube.com/embed/${parseYoutubeID(item.youtube)}" allowfullscreen></iframe>
      <div class="card-info">
        <div class="rank">#${item.rank}</div>
        <div class="level-name">${item.name}</div>
        <div class="creator">by ${item.creator}</div>
      </div>
      <div class="card-sender">${item.discord}</div>
      <button class="delete">X</button>
    `;
    submissionList.appendChild(card);

    card.querySelector('.delete').addEventListener('click', ()=>{
      let lb = JSON.parse(localStorage.getItem('leaderboard')||'[]');
      lb = lb.filter(e=>!(e.name===item.name && e.discord===item.discord));
      localStorage.setItem('leaderboard', JSON.stringify(lb));
      loadSubmissions();
    });
  });
}

function parseYoutubeID(url){
  try{
    const u = new URL(url);
    if(u.hostname.includes('youtu.be')) return u.pathname.slice(1);
    if(u.searchParams.get('v')) return u.searchParams.get('v');
    return '';
  } catch{return '';}
}
</script>
</body>
</html>
